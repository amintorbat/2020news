## راهنمای Frontend – ۲۰۲۰نیوز

### ساختار پروژه
- `app/` شامل مسیرهای App Router است؛ صفحه اصلی (`app/page.tsx`) داده‌ها را از ACS دریافت می‌کند و صفحه‌های `news`, `matches`, `standings` هر کدام وظایف جداگانه دارند.
- `components/` شامل بلوک‌های صفحه است؛ فایل‌های `components/home/*` ویجت‌های صفحه اصلی (اسلایدر، اخبار، بازی‌ها، جدول لیگ) و `components/layout/*` عناصر سراسری مثل ناوبار و فوتر را نگه می‌دارند.
- `lib/acs/` منطق Adaptive Content Sync را مدیریت می‌کند؛ هر فایل یک منبع داده مستقل (خانه، جدول لیگ، مسابقات، جزئیات خبر) را مسئول است.
- `lib/data.ts` فقط برای داده‌های آزمایشی و fallback استفاده می‌شود؛ هیچ لینک خارجی را مستقیماً به UI ارسال نمی‌کند.

### لایه ACS
- تمام Fetch‌ها در سمت سرور و از طریق `fetchWithRetry` انجام می‌شوند که دارای timeout، retry و header‌های سفارشی است.
- داده‌ها به مدل‌های تایپ‌شده (`Article`, `Match`, `StandingsRow`) نگاشت می‌شوند؛ مقادیر مهمی مانند `slug`، `sport` و `imageUrl` همیشه مقداردهی می‌شوند تا UI دچار خطا نشود.
- برای هر منبع (`home.ts`, `matches.ts`, `standings.ts`, `articleDetail.ts`) یک fallback تعریف شده (`fallback.ts`) تا هنگام قطعی مبدأ، خروجی معنی‌دار باقی بماند.
- لاگ‌ها با `logWarnOnce` کنترل می‌شوند تا هر خطا فقط یک‌بار هشدار دهد و کنسول از پیام‌های تکراری خالی بماند.

### مسئولیت اجزا
- **HeroSlider**: حداکثر ۶ خبر را با تصویر سمت راست و متن سمت چپ نمایش می‌دهد و همیشه از تصویر جایگزین استفاده می‌کند.
- **NewsList / NewsCard**: در صفحه اصلی فقط ۶ خبر مهم با چینش تصویربالا-متن پایینی نشان داده می‌شود و مسیر کلیک همیشه داخلی (`/news/[slug]`) است.
- **MatchesTabs**: برنامه بازی‌ها را بر اساس لیگ و وضعیت (امروز/هفته جاری) تفکیک کرده و برچسب‌های وضعیت را با رنگ‌بندی مشخص نشان می‌دهد.
- **LeagueTablesPreview**: فقط یک کارت فشرده نشان می‌دهد و با تب به لیگ‌های دیگر تغییر می‌کند؛ در صورت نبود داده پیام خالی نمایش داده می‌شود.
- **News pages**: `app/news/page.tsx` اخبار باقی‌مانده را بر اساس رشته دسته‌بندی می‌کند و `app/news/[slug]/page.tsx` بدنه کامل خبر را از ACS می‌کشد.

### فلسفه مدیریت خطا
- هر Fetch در try/catch پیچیده شده و در صورت شکست، یک‌بار هشدار داده می‌شود و سپس به داده‌های محلی برمی‌گردد.
- تمام لینک‌ها به صفحات داخلی هدایت می‌شوند؛ حتی وقتی منبع اصلی ۲۰۲۰نیوز در دسترس نباشد، صفحه با متن جایگزین و تصویر ثابت بارگذاری می‌شود.
- هر کامپوننت قبل از رندر شرایط خالی (مانند آرایه بدون عضو) را بررسی می‌کند تا هیچ Box سفید بدون محتوا ایجاد نشود.

### توسعه آتی
- برای پوشش خبرهای بیشتر، می‌توان ماژول دیگری در `lib/acs/` برای آرشیو (مثلاً `/Archive`) اضافه کرد و نتیجه آن را در صفحه خبر استفاده کرد.
- می‌توان لایه کش (Redis/Vercel KV) را در کنار کش درون‌حافظه‌ای فعلی اضافه کرد تا پاسخ‌ها میان چندین منطقه سرور هم به اشتراک گذاشته شوند.
- برای بهبود سئو، پیشنهاد می‌شود متادیتای دینامیک (OG و Structured Data) بر اساس Article Detail تزریق شود.
